#  -*- mode: unix-shell-script; -*-

# Generate tab completions
# This updates generated completions that cannot be directly loaded in zshrc

emulate -L zsh

COMPLETIONS_DIR=${ZDOTDIR:-$HOME/.zsh}/completions
mkdir -p ${COMPLETIONS_DIR}

# Swift
if installed swift; then
	printf "Generating swift completions...\n"
	swift package completion-tool generate-zsh-script > ${COMPLETIONS_DIR}/_swift
fi

# Rust
if installed rustup; then
	for f in rustup cargo; do
		printf "Generating ${f} completions...\n"
		rustup completions zsh ${f} > ${COMPLETIONS_DIR}/_${f}
	done
fi

# if [[ -f /Applications/YubiKey\ Manager.app/Contents/MacOS/ykman ]]; then
# 	printf "Generating ykman completions...\n"
# 	_YKMAN_COMPLETE=source /Applications/YubiKey\ Manager.app/Contents/MacOS/ykman > ${COMPLETIONS_DIR}/_ykman
# fi


printf "Reload shell to load completions.\n"
